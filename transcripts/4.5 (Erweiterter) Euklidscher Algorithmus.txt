 Als nächstes schauen wir uns an den Euclidischen Algorithmus zur Berechnung des größten gemeinsamen Teilers von zwei Zahlen a und b. Wenn Sie diesen größten gemeinsamen Teiler berechnet haben von a und b, dann können Sie auch das kleinste gemeinsame Vielfache leicht berechnen, indem Sie einfach das Produkt von a und b durch diesen größten gemeinsamen Teiler teilen. Des Weiteren fällt aus dem Euclidischen Algorithmus, Sie können das so modifizieren, das nennt sich dann erweiterte Euclidische Algorithmus, dass die BESU-Koeffizienten damit herausfallen. Unser Ziel ist also den größten gemeinsamen Teiler von a und b effizient zu berechnen. Wir könnten die Primfaktorzerlegung von a und b nehmen und jeweils für jeden Primfaktor das Minimum aus der Potenz, wie sie in der Primfaktorzerlegung von a vorkommt, und wie sie in der Primfaktorzerlegung von b vorkommt, benutzen. Also im GGT kommt b1 genau Min von a1 b1 häufig vor. Das könnten Sie natürlich machen, aber das Problem ist, dass wir keine effiziente Methode bekennen, um die Primfaktorzerlegung von a und b zu berechnen. Es ist allerdings leichter, statt zu versuchen die Teile von a zu bestimmen und die Teile von b zu bestimmen, ist es leichter, gemeinsame Teile von a und b zu bestimmen. Was ich damit meine, würde ich mal hier an diesem Beispiel illustrieren. Sagen wir mal, wir wollen den größten gemeinsamen Teiler bestimmen von 91 und 287. Dann könnten wir spaßeshalber mal gucken, was ist denn der Rest, den 287 bei Division durch 91 lässt. Das ist 14. Dann können wir beobachten, dass jeder gemeinsame Teiler, also jede Zahl, die sowohl 91 als auch 287 teilt, muss auch den Rest nach Division teilen. Also für gemeinsame Teile von 91 und 287 kommen nur Teile von 14 in Frage. Das ist jetzt schon sehr viel einfacher, die Teile von 14 zu bestimmen. Insbesondere ist auch der größte Teiler von 91 und 287 ein Teiler von 14. Also ist der größte Teiler von 91 und 287 der größte Teiler von 91 und 14. Jetzt können Sie das aber wiederholt machen. Sie können sich auch fragen, was ist denn, wenn wir den Rest bilden von 91 nach Division durch 14. Und dann kommt drauf 7, das heißt wieder können Sie schlussfolgern, die gemeinsamen Teiler von 91 und 14 müssen auch 7 teilen. Also ist GGT der größte gemeinsame Teiler von 91 und 14, ist der größte gemeinsame Teiler von 14 und 7 und das ist 7. Und damit können wir jetzt zurückverfolgen, 7 ist der größte gemeinsame Teiler von 91 und 14. Der größte gemeinsame Teiler von 14 und 7, also auch der größte gemeinsame Teiler von 91 und 14. Das wiederum ist der größte gemeinsame Teiler von 91 und 287. Und das ist genau was wir haben wollten. Auf diese Art und Weise lässt sich relativ effizient der größte gemeinsame Teiler von großen Zahlen bestimmen. Ohne deren Primfaktorzerlegung bestimmen zu müssen. Das machen wir jetzt allerdings nochmal formal sauber. Der Dämmer sagt, wir haben Zahlen a, b und d, sodass b geteilt wird von d. Und wir haben hier diesen Rest nach Division von a durch b. Dann haben wir, dass d genau dann a teilt, wenn d r teilt. Und das heißt insbesondere, dass alle gemeinsamen Teiler von b und a, sind auch gemeinsame Teiler von b und r. Und damit ist auch der größte gemeinsame Teiler von b und a, gleich dem größten gemeinsamen Teiler von b und r. Also können wir einfach unser a durch r ersetzen in der GGT-Berechnung. Zum Beweis nehmen wir uns zwei Zahlen q und s her, sodass a gleich b mal q plus r. Also q ist a div b. Und s kommt hiervon. Also da b teilt, gibt es irgendein s, sodass b gleich d mal s. Und dann teilen wir wieder den Beweis auf in die Richtung von links nach rechts. Und von rechts nach links. Machen wir erstmal von links nach rechts. Da haben wir zur Verfügung, dass a von d geteilt wird. Also hier d teilt a. Per Definition gibt es also ein x, sodass wenn ich das x an d ran multipliziere, ich a rauskriege. Und dann kann ich hier oben diese Formel benutzen, die sagt, okay, r ist a minus b mal q. Und das ist wiederum, ah ja, dann kann ich hier meinen a ersetzen durch d mal x. Also es gibt dieses x, sodass a gleich d mal x ist. Also gibt es das x, sodass diese Gleichheit gilt. Und dann setze ich für mein b diese Formel hier oben ein. Und das heißt, hier habe ich zu stehen d mal irgendwas. Und auf der anderen Seite steht r. Also ist es so, dass r von d geteilt wird. Und das ist das, was wir zeigen wollten hier. Also als nächste Rückrichtung, da haben wir zur Verfügung, dass r von d geteilt wird. Also d teilt r. Also gibt es irgendein s, sodass b gleich d teilt wird. Und das ist das, was wir jetzt zeigen wollen. Also wir wollen jetzt zeigen, dass r von d geteilt wird. Also d teilt r. Also gibt es irgendwie per Definition ein y, sodass sich r schreiben lässt als d mal y. Und daraus wollen wir jetzt zeigen, dass a von d geteilt wird. Also mit anderen Worten, dass wir a schreiben können als d mal irgendwas. Also wir schreiben jetzt a und versuchen zu zeigen, dass das Produkt ist aus d mit irgendwas. Wir benutzen wieder hier die Gleichung. a ist gleich b mal q plus r. Und können wieder b ersetzen durch d mal s. Also d mal s mal q plus r. Und r können wir hier ersetzen mit d mal y. Also können wir das Ganze schreiben als ein Produkt von d mit irgendwas. Und das heißt hier steht wieder a ist gleich d mal irgendwas. Das bedeutet a wird geteilt von d. Also wie ich es vorhin schon mal gesagt hatte, die gemeinsamen Teiler von a und b sind genau die gemeinsamen Teiler von b und r. Also ist auch der größte gemeinsame Teiler von a und b gleich dem größten gemeinsamen Teiler von b und r. Und das benutzen wir jetzt im euclidischen Algorithmus, um dieses gget auszurechnen. Also hier ist es nur nochmal hingeschrieben. Wenn wir zwei Zeilen haben, dann ist das gget von a und b gleich dem gget von b und dem Rest bei Division von a durch b. Also hier links habe ich Ihnen mal den Pseudocode hingeschrieben vom euclidischen Algorithmus. Und wundern Sie sich nicht über die Zeilennummerierung hier. Das ändert sich nachher noch, wenn wir den erweiterten euclidischen Algorithmus hier einfügen. Deswegen sind die ein bisschen durcheinander. Und hier drüben habe ich als Beispiel mal hingeschrieben die Berechnung zum größten gemeinsamen Teiler von 414 und 662. Und es läuft jetzt auch genauso ab, wie wir uns das vorbereitet haben. Also wir fangen an mit a und b. Und um den gget von a und b auszurechnen, berechnen wir den Rest bei Division von a durch b. In diesem Fall hier 414 durch 662 lässt genau den Rest 414 sein. Also diese Division hier, da schreiben wir immer den Rest in das rnew rein. Deswegen heißt es auch rnew, weil es den neuen Rest enthält. Und das neue a ist einfach das alte b. Also das wird dann so rüber übertragen hier. Das heißt, wenn Sie sagen, hier ist der nächste Schritt in jedem Schritt, wird das r bestimmt aus dem alten rnew. Und das rnew wird bestimmt aus dem Rest der Division der vorherigen Werte. Das sehen Sie hier auch genau im Pseudocode. Also das r wird bestimmt vom alten rnew und das neue rnew wird bestimmt als Rest der Division von dem alten r. Also geteilt durch das alte r. Und das neue r wird bestimmt durch den Rest der Division der vorherigen Werte. Also von dem alten r und dem alten r, also geteilt durch das alte rnew. Also jetzt hier in der nächsten Operation. Was haben wir hier? r geteilt durch rnew, also 662 durch 414. Das lässt den Rest 248. Und vielleicht mache ich es doch ein bisschen farbig. Das wird rüber übertragen, das ist dieser Schritt. Und den anderen Schritt machen wir vielleicht mal rot, der kommt aus der Division. Bzw. aus dem Berechnen des Restes. Ok, also der wird übertragen hier runter. Und genau, also haben wir jetzt das in diesem Fall hier. Haben wir jetzt bestimmt, dass das gget von 414 und 662 ist das gleiche wie das gget von 414 und 248. Und das kann man jetzt so weiterspielen hier. Also hier die Division bilden. Da kommt Rest 166 raus. Und die 248 ziehen wir einfach wieder rüber. Dann dividieren wir weiter. 248 durch 166 lässt den Rest 82. Und die 166 wird wieder übertragen. Dann 166 durch 82 lässt den Rest 2. Und das übertragen wir auch wieder. Und 82 durch 2, das geht auf, lässt den Rest 0. Und das Spielchen geht, wie Sie hier sehen, genau bis zu dem Punkt, wo Rnew, also hier diese rechte Seite quasi, die 0 wird. Also haben wir durch diese Gette festgestellt, dass der größte gemeinsame Teiler, den wir hier gesucht haben, der ist gleich der größte gemeinsame Teiler von 2 und 0. Wir wissen, alles teilt 0. Also ist es einfach der größte gemeinsame Teiler von irgendwas und 0 ist quasi genau das irgendwas. Weil alles ein Teiler von 0 ist, ist auch das irgendwas hier ein Teiler von 0. Das heißt, in diesem Fall haben wir rausbekommen, da hier am Ende der 2 steht, übertragen von 0. Übertragen von dort. Stellen wir fest, dass der größte gemeinsame Teiler von 441 und 662 gleich 2 ist. Und das ist genau hier dieses return statement. Ich habe jetzt irgendwie diese 2 hier oben rot gemalt, statt die 2 da unten, aber naja, das ist derselbe Wert. Wenn wir jetzt daraus übergehen wollen zum erweiterten Euclidischen Algorithmus, schauen wir uns hier hinten diese Modulu-Berechnung an und schreiben wir statt Rmodulu Rnew, schreiben wir hier R-Rnew mal R, ganze Zeit die Division, durch Rnew. Durch Rnew, also das ist R-, das hier ist die andere Darstellung für den Rest, den R bei Division durch Rnew lässt. Nur, dass wir jetzt noch zusätzlich hier diesen Quotienten haben. Und wozu brauchen wir den? Das brauchen wir jetzt, um mindestens einen von den Bezug-Koeffizienten mitzuschleifen. Nämlich im jetzt erweiterten Euclidischen Algorithmus haben wir noch zusätzlich, ich habe jetzt gesagt, ich werde diesen S-Bezug-Koeffizienten berechnen, das können Sie auch machen, Sie können auch S und T gleichzeitig mitberechnen, aber es reicht S zu berechnen, denn wir wissen ja dann, A mal S plus B mal T ist GGT von A und B. Und wenn Sie diesen erweiterten Euclidischen Algorithmus haben laufen lassen, dann wissen Sie das GGT, dann wissen Sie S, A und B wissen Sie sowieso, also können Sie sich dann einfach T ausrechnen. Also aus diesem Grunde werde ich jetzt erstmal nur den erweiterten Euclidischen Algorithmus mit dem S hier vorstellen. Also da fangen Sie an mit, auch wieder so ein S und Snew, es gibt auch wieder so eine Folge hier von S. Sie fangen an mit 1 und 0 in diesem Fall. Und wie Sie das S und das Snew updaten, ist dann, dass Sie analog zu den Resten hier, bilden Sie S minus Snew mal Q und am Ende geben Sie zusammen mit dem R das S aus. Und in jedem Schritt ist die Invariante, dass sich dieses Rnew hier schreiben lässt als Snew mal ihrem A plus T mal ihrem B. Also das ist A, das ist B. In jedem Schritt ist die Invariante, dass es ein T gibt, sodass dieses Rnew gleich dem Snew mal A plus T mal B ist. Also in diesem Fall hier, 662 ist 0 mal 414 plus 1 mal 662. Die 414 ist 1 mal 414 plus 0 mal 662. Das ist minus 1 mal 414 plus 1 mal 662. Und dann haben wir 166, das sind 2 mal 414 minus 662, also minus 1 mal. Und 82 sind minus 3 mal 414 plus 2 mal 662, hoffe ich zumindest. Und dann schlussendlich haben wir 2, das sind 8 mal 414 minus 5 mal 662. Also Sie haben hier immer so eine Invariante, dass es ein T gibt, sodass Sie mit diesem S hier vorne eine Linearkombination bilden können aus A und B, die genau dieses aktuelle Rnew darstellt. Und das letzte Rnew hier ist dann halt genau das GGT, also lässt sich mit dieser letzten Linearkombination hier, vielleicht sollte ich plus, minus, 5, also mit dieser letzten Linearkombination hier lässt sich genau das GGT als Linearkombination von A und B aufschreiben.